# Redis事务

Redis事务可以一次执行多个命令。（按顺序依次执行，中间不允许任何其他命令执行；）

Redis事务不支持事务回滚。

## 命令

```shell
MULTI		# 开启事务;
EXEC    	# 执行事务块内的所有命令
DISCARD 	# 取消事务块内的所有命令

WATCH		# 监视一个/多个key,如果在事务执行之前这个key被修改,那么事务将被打断;
UNWATCH		# 取消所有Key的监视;
```



操作一:

```shell
127.0.0.1:6379> MULTI
OK
127.0.0.1:6379> get jack
QUEUED
127.0.0.1:6379> set jack beautiful ex 1000
QUEUED
127.0.0.1:6379> keys *
QUEUED
127.0.0.1:6379> EXEC 
1) (nil)
2) OK
3) 1) "jack"
```

操作二:

```

```



一个事务从开始到结束经历三个阶段:

- 开始事务
- 命令入队
- 执行/取消事务

输入`multi` 命令代表一个事务的开始，输入的命令都会依次进入命令队列中，但不会执行；

输入`exec` 命令后，Redis会将命令队列中的命令依次执行；

使用 `discard` 命令释放命令队列数据，放弃事务的执行；



## 事务的错误处理

Redis的事务错误处理分**两种情况**：

1. 加入命令队列的过程中，发生报错（如命令输入错误），则整个命令队列都会被取消，事务结束；
2. 执行命令队列时，发生报错，则只是报错的命令不会执行，其他命令正常执行；







